# 商家推荐系统使用指南

## 🎯 功能概述

商家推荐系统是权益平台V5的核心功能之一,旨在为申请政府补贴的用户提供智能化的商家推荐服务,帮助用户快速找到合适的商家完成消费,形成"补贴申请 → 商家推荐 → 消费转化"的完整业务闭环。

---

## 🚀 快速开始

### 用户端使用流程

#### 第一步: 完成实名认证

1. 打开应用,进入"我的"页面
2. 点击"实名认证"入口
3. 按照提示完成4步认证流程:
   - 填写个人信息
   - 上传身份证照片
   - 人脸识别验证
   - 完成认证

> ⚠️ **重要**: 只有完成实名认证后才能查看商家推荐

#### 第二步: 进入政府补贴页面

1. 从首页或底部导航进入"政府补贴"
2. 查看可申请的补贴政策
3. 在页面顶部可以看到"推荐商户"区域

#### 第三步: 查看商家推荐

**方式一: 在补贴主页查看**
- 位置: 补贴政策列表顶部
- 展示: 3个推荐商家
- 操作: 点击"查看全部"查看更多

**方式二: 申请成功后查看**
- 位置: 补贴申请成功页面
- 展示: 根据申请类型推荐的3个商家
- 操作: 点击商家卡片查看详情

#### 第四步: 查看商家详情

1. 点击任意商家卡片
2. 跳转到商家详情页
3. 查看商家信息:
   - 基本信息(名称、地址、电话)
   - 评分和评价
   - 优惠信息
   - 营业时间
   - 特色服务
   - 资质认证

#### 第五步: 联系商家

在商家详情页可以:
- 📞 拨打电话咨询
- 🗺️ 导航到商家位置
- 💰 查看优惠详情
- ⭐ 查看用户评价

---

## 📊 商家推荐逻辑

### 推荐算法说明

系统采用多维度智能评分算法,综合考虑以下因素:

#### 1. 距离因素 (权重30%)

- 基于用户当前位置
- 距离越近,分数越高
- 计算公式: `距离分数 = max(0, 100 - 距离(km) × 10)`

**示例**:
- 1公里内: 90-100分
- 1-3公里: 70-90分
- 3-5公里: 50-70分
- 5公里以上: <50分

#### 2. 质量因素 (权重30%)

- 商家评分(1-5星)
- 评价数量
- 计算公式: `质量分数 = 评分 × 20 + min(评价数/100, 1) × 20`

**示例**:
- 5星+1000评价: 100分
- 4.5星+500评价: 90-95分
- 4星+200评价: 80-85分

#### 3. 人气因素 (权重20%)

- 销量数据
- 成立年限
- 计算公式: `人气分数 = min(销量/500, 1) × 50 + min(年限/10, 1) × 50`

**示例**:
- 销量5万+,成立10年+: 100分
- 销量2万+,成立5年+: 75分
- 销量1万+,成立3年+: 50分

#### 4. 优惠因素 (权重20%)

- 优惠力度(0-100%)
- 计算公式: `优惠分数 = 优惠力度`

**示例**:
- 20%优惠: 20分
- 15%优惠: 15分
- 10%优惠: 10分

### 综合评分公式

```
总分 = 距离分数 × 0.3 + 质量分数 × 0.3 + 人气分数 × 0.2 + 优惠分数 × 0.2
```

**评分等级**:
- 90-100分: ⭐⭐⭐⭐⭐ 强烈推荐
- 80-89分: ⭐⭐⭐⭐ 推荐
- 70-79分: ⭐⭐⭐ 可选择
- 60-69分: ⭐⭐ 备选
- <60分: 不推荐

---

## 🏪 商家类型说明

系统支持6大类商家,对应不同的补贴类型:

### 1. 汽车经销商 (car_dealer)

**对应补贴**: 汽车以旧换新补贴

**典型商家**:
- 江苏汽车城
- 苏宁汽车
- 各品牌4S店

**服务特色**:
- 官方授权
- 以旧换新
- 金融服务
- 上门试驾

### 2. 家电商店 (appliance_store)

**对应补贴**: 家电以旧换新补贴、智能绿色家电补贴

**典型商家**:
- 苏宁易购
- 国美电器
- 京东家电

**服务特色**:
- 品类齐全
- 送货上门
- 免费安装
- 旧机回收

### 3. 家具商店 (furniture_store)

**对应补贴**: 家具以旧换新补贴

**典型商家**:
- 宜家家居
- 红星美凯龙
- 居然之家

**服务特色**:
- 设计服务
- 配送安装
- 环保材质
- 质保服务

### 4. 装修公司 (renovation_company)

**对应补贴**: 住房装修补贴

**典型商家**:
- 金螳螂装饰
- 东易日盛
- 业之峰装饰

**服务特色**:
- 设计施工一体
- 环保材料
- 质保承诺
- 分期付款

### 5. 3C数码店 (3c_store)

**对应补贴**: 3C产品补贴

**典型商家**:
- Apple Store
- 小米之家
- 华为体验店

**服务特色**:
- 正品保证
- 以旧换新
- 专业服务
- 技术支持

### 6. 绿色家电店 (green_appliance)

**对应补贴**: 智能绿色家电补贴

**典型商家**:
- 专业绿色家电店
- 节能产品专卖店

**服务特色**:
- 节能认证
- 智能化产品
- 环保材质
- 政府认可

---

## 💡 使用技巧

### 技巧1: 优先查看高分商家

- 推荐分数90+的商家通常综合实力最强
- 关注"推荐度"徽章,数字越大越好

### 技巧2: 关注距离和优惠

- 距离近的商家节省时间和交通成本
- 优惠力度大的商家更实惠
- 在距离和优惠之间找平衡

### 技巧3: 查看评价和资质

- 评价数多的商家更可靠
- 有官方认证的商家更有保障
- 查看用户真实评价了解服务质量

### 技巧4: 提前电话咨询

- 确认补贴政策支持情况
- 了解库存和价格
- 预约到店时间
- 咨询具体优惠细节

### 技巧5: 对比多家商家

- 点击"查看全部"浏览更多商家
- 对比价格、服务、评价
- 选择最适合自己的商家

---

## 🔧 开发者指南

### 组件使用

#### 基础用法

```vue
<template>
  <MerchantRecommend 
    :subsidy-type="'car'"
    :limit="3"
  />
</template>

<script setup>
import MerchantRecommend from '@/components/subsidy/MerchantRecommend.vue'
</script>
```

#### Props说明

| 参数 | 类型 | 必填 | 默认值 | 说明 |
|------|------|------|--------|------|
| subsidyType | SubsidyType | 是 | - | 补贴类型 |
| limit | number | 否 | 5 | 显示商家数量 |

#### SubsidyType枚举

```typescript
type SubsidyType = 
  | 'car'                    // 汽车以旧换新
  | 'appliance'              // 家电以旧换新
  | 'furniture'              // 家具以旧换新
  | 'renovation'             // 住房装修
  | '3c'                     // 3C产品
  | 'smart_green_appliance'  // 智能绿色家电
```

### Store使用

#### 获取推荐商家

```typescript
import { useMerchantStore } from '@/stores/merchant'

const merchantStore = useMerchantStore()

// 获取推荐商家
const merchants = merchantStore.recommendMerchants('car', 5)

// 格式化距离
const distance = merchantStore.formatDistance(1500) // "1.5km"

// 获取用户位置
await merchantStore.getCurrentLocation()
```

#### 商家数据结构

```typescript
interface Merchant {
  id: string                    // 商家ID
  name: string                  // 商家名称
  category: MerchantCategory    // 商家类别
  logo: string                  // Logo URL
  images: string[]              // 图片列表
  rating: number                // 评分(1-5)
  reviewCount: number           // 评价数
  location: {                   // 位置信息
    lat: number
    lng: number
    address: string
    district: string
  }
  distance?: number             // 距离(米)
  discountRate: number          // 优惠力度(0-100)
  subsidySupport: SubsidyType[] // 支持的补贴类型
  tags: string[]                // 标签
  description: string           // 描述
  phone: string                 // 电话
  businessHours: string         // 营业时间
  features: string[]            // 特色服务
  certifications: string[]      // 资质认证
  salesVolume: number           // 销量
  establishedYear: number       // 成立年份
}
```

### 添加新商家

在 `merchant.ts` 中添加:

```typescript
{
  id: 'm031',
  name: '新商家名称',
  category: 'car_dealer',
  logo: 'https://example.com/logo.png',
  images: ['https://example.com/img1.jpg'],
  rating: 4.8,
  reviewCount: 1000,
  location: {
    lat: 32.0603,
    lng: 118.7969,
    address: '详细地址',
    district: '区域'
  },
  discountRate: 15,
  subsidySupport: ['car'],
  tags: ['标签1', '标签2'],
  description: '商家描述',
  phone: '025-1234-5678',
  businessHours: '9:00-21:00',
  features: ['特色1', '特色2'],
  certifications: ['认证1', '认证2'],
  salesVolume: 10000,
  establishedYear: 2015
}
```

### 自定义推荐算法

修改 `merchant.ts` 中的权重:

```typescript
const totalScore = 
  distanceScore * 0.3 +    // 距离权重
  qualityScore * 0.3 +     // 质量权重
  popularityScore * 0.2 +  // 人气权重
  discountScore * 0.2      // 优惠权重
```

---

## 🐛 常见问题

### Q1: 为什么看不到商家推荐?

**A**: 请检查以下条件:
1. 是否已完成实名认证
2. 是否在政府补贴页面
3. 是否选择了补贴类型

### Q2: 商家距离如何计算?

**A**: 系统使用Haversine公式计算地球表面两点间的实际距离,精度较高。

### Q3: 推荐分数如何计算?

**A**: 综合考虑距离、质量、人气、优惠四个维度,详见"推荐算法说明"章节。

### Q4: 可以手动选择位置吗?

**A**: 当前版本使用默认位置(南京市中心),后续版本将支持手动选择和GPS定位。

### Q5: 商家信息如何更新?

**A**: 开发者可以在 `merchant.ts` 中更新商家数据,生产环境建议接入后端API。

---

## 📞 技术支持

### 开发团队

- **项目**: 权益平台V5
- **功能**: 商家推荐系统
- **版本**: 1.0.0

### 相关文件

- `/src/stores/merchant.ts` - 商家数据Store
- `/src/components/subsidy/MerchantRecommend.vue` - 推荐组件
- `/src/views/MerchantDetail.vue` - 商家详情页
- `/src/views/GovSubsidy.vue` - 政府补贴主页

### 文档

- 《商家推荐系统集成完成报告.md》
- 《政府补贴品类扩展实施总结.md》
- 《实名认证功能完善总结.md》

---

## 🎉 总结

商家推荐系统为用户提供了智能化的商家发现和选择服务,通过多维度评分算法,帮助用户快速找到最合适的商家。系统设计充分考虑了用户体验和业务转化,是权益平台的重要功能模块。

**核心优势**:
- ✅ 智能推荐,精准匹配
- ✅ 多维评分,综合考量
- ✅ 无缝集成,流畅体验
- ✅ 完整闭环,促进转化

祝您使用愉快! 🎊

